<!DOCTYPE html>
<html>
<head>
    <title>Admin</title>
</head>
<body>
    <!-- user data -->
    <p>Click the create button to create a new user data</p>
    <form id="createUserForm">
        <label for="newUserEmail">New user email:</label>
        <input type="text" id="newUserEmail" name="newUserEmail">
        <br>
        <label for="newUserPassword">New user Password:</label>
        <input type="text" id="newUserPassword" name="newUserPassword">
        <br>
        <label for="newUserFirstName">New user first name:</label>
        <input type="text" id="newUserFirstName" name="newUserFirstName">
        <br>
        <label for="newUserLastName">New user last name:</label>
        <input type="text" id="newUserLastName" name="newUserLastName">
        <br>
        <label for="newUserRole">Choose a role:</label>
        <select name="newUserRole" id="newUserRole">
            <option value="user">User</option>
            <option value="admin">Admin</option>
        </select>
        <input type="submit" value="Submit">
    </form>
    <br>
    
    <p>Click the read button to read user data</p>
    <form id="readUserForm">
        <label for="readUser">User email:</label>
        <input type="submit" id="readUser" name="readUser" value="Submit">
    </form>
    <br>

    <p>Click the load button to load a user data</p>
    <form id="loadUserForm">
        <label for="loadUserEmail">User Email:</label>
        <input type="text" id="loadUserEmail" name="loadUserEmail"required>
        <br>
        <input type="submit" value="Load User">
    </form>

    <p>Click the update button to update a user data</p>
    <form id="updateUserForm">
        <label for="updateUserEmail">Email:</label>
        <input type="text" id="updateUserEmail" name="updateUserEmail"required>
        <br>
        <label for="updateUserPassword">Password:</label>
        <input type="text" id="updateUserPassword" name="updateUserPassword"required>
        <br>
        <label for="updateUserFirstName">First Name:</label>
        <input type="text" id="updateUserFirstName" name="updateUserFirstName"required>
        <br>
        <label for="updateUserLastName">Last Name:</label>
        <input type="text" id="updateUserLastName" name="updateUserLastName"required>
        <br>

        <input type="submit" value="Update User">
    </form>
    <br>

    <p>Click the delete button to delete a user data</p>
    <form id="deleteUserForm">
        <label for="deleteUserEmail">User email:</label>
        <input type="text" id="deleteUserEmail" name="deleteUserEmail">
        <br>
        <input type="submit" value="Delete">
    </form>
    <br>


    <!-- location and event data -->
    <p>Click the find button to find a event</p>
    <form id="findEventIdForm">
        <label for="findEventId">Event ID:</label>
        <input type="text" id="findEventId" name="findEventId">
        <br>
        <input type="submit" value="Submit">
    </form>
    <br>

    <p>Click the create button to create a new event data</p>
    <form id="createEventForm">
        <label for="newEventName">Event name:</label>
        <input type="text" id="newEventName" name="newEventName">
        <br>
        <label for="newEventQuota">Event quota:</label>
        <input type="text" id="newEventQuota" name="newEventQuota">
        <br>
        <label for="locationName">Location name:</label>
        <input type="text" id="locationName" name="locationName">
        <br>
        <input type="submit" value="Submit">
    </form>
    <br>

    <p>Click the delete button to delete a event data</p>
    <form id="deleteEventForm">
        <label for="deleteEvent">Event ID:</label>
        <input type="text" id="deleteEvent" name="deleteEvent">
        <br>
        <input type="submit" value="Delete">
    </form>    

    <p>Click the button to list all event data</p>
    <form id="listEventForm">
        <label for="listEvent">List every event</label>
        <br>
        <input type="submit" value="Submit" id="listEvent" name="listEvent">
    </form> 

    <p>Click the find button to find a location</p>
    <form id="findLocationNameForm">
        <label for="findLocationName">Location name:</label>
        <input type="text" id="findLocationName" name="findLocationName">
        <br>
        <input type="submit" value="Submit">
    </form>
    <br>

    <p>Click the button to list all location data</p>
    <form id="listLocationForm">
        <label for="listLocation">List every location</label>
        <br>
        <input type="submit" value="Submit" id="listLocation" name="listLocation">
    </form> 

    <p>Click the update button to update a event data</p>
    <form id="loadEventForm">
        <label for="loadEventId">Event ID:</label>
        <input type="text" id="loadEventId" name="loadEventId"required>
        <br>
        <input type="submit" value="Load Event">
    </form>
    
    <form id="updateEventForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name"required>

        <label for="quota">Quota:</label>
        <input type="number" id="quota" name="quota" required>

        <label for="loc">Location Id:</label>
        <input type="text" id="loc" name="loc" required>

        <input type="submit" value="Update Event">
    </form>
    <br>

    <script>

        // create a new user data
        document.getElementById('createUserForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            console.log("creating user");
            const userEmail = document.getElementById('newUserEmail').value;
            const userPassword = document.getElementById('newUserPassword').value;
            const userFirstName = document.getElementById('newUserFirstName').value;
            const userLastName = document.getElementById('newUserLastName').value;
            const userRole = document.getElementById('newUserRole').value;
            const data = {
                userEmail: userEmail,
                userPassword: userPassword,
                userFirstName: userFirstName,
                userLastName: userLastName,
                userRole: userRole,
            };
            const url = 'http://localhost:3000/createNewUser';

            const response = await fetch(url, { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            
            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
            
        });

        // read every user data
        document.getElementById('readUserForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const url = 'http://localhost:3000/readUser';

            const response = await fetch(url, { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        // update a user data
        document.getElementById('loadUserForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const loadUserEmail = document.getElementById('loadUserEmail').value;
            const url = 'http://localhost:3000/loadUser/'+loadUserEmail;

            const response = await fetch(url, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
            });
            const userData = await response.json();
            document.getElementById('updateUserEmail').value = userData.email;
            document.getElementById('updateUserPassword').value = userData.password;
            document.getElementById('updateUserFirstName').value = userData.firstName;
            document.getElementById('updateUserLastName').value = userData.lastName;
        });

        document.getElementById('updateUserForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            let userEmail = document.getElementById('loadUserEmail').value;
            const updateUserEmail = document.getElementById('updateUserEmail').value;
            const updateUserPassword = document.getElementById('updateUserPassword').value;
            const updateUserFirstName = document.getElementById('updateUserFirstName').value;
            const updateUserLastName = document.getElementById('updateUserLastName').value;
            const url = 'http://localhost:3000/updateUser/'+userEmail;

            const data = {
                "email": updateUserEmail,
                "password": updateUserPassword,
                "firstName": updateUserFirstName,
                "lastName": updateUserLastName,
            };
            const response = await fetch(url, { 
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data),
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });   


        document.getElementById('deleteUserForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const deleteUserEmail = document.getElementById('deleteUserEmail').value;

            const url = 'http://localhost:3000/deleteUser/'+deleteUserEmail;

            const response = await fetch(url, { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        // location and events
        document.getElementById('findEventIdForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            let eventId = document.getElementById('findEventId').value;
            const url = 'http://localhost:3000/ev/'+eventId;

            const response = await fetch(url, { 
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        document.getElementById('createEventForm').addEventListener('submit', async (event) => {
            event.preventDefault();

            const newEventName = document.getElementById('newEventName').value;
            const newEventQuota = document.getElementById('newEventQuota').value;
            const locationName = document.getElementById('locationName').value;
            const data = {
                "name": newEventName,
                "quota": newEventQuota,
                "locationName": locationName,
            };
            const url = 'http://localhost:3000/ev';
            console.log(url);
            const response = await fetch(url, { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        document.getElementById('deleteEventForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            let eventId = document.getElementById('deleteEvent').value;
            const url = 'http://localhost:3000/ev/'+eventId;

            const response = await fetch(url, { 
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        document.getElementById('listEventForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const url = 'http://localhost:3000/ev';

            const response = await fetch(url, { 
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        document.getElementById('findLocationNameForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            let locationName = document.getElementById('findLocationName').value;
            const url = 'http://localhost:3000/lo/'+locationName;

            const response = await fetch(url, { 
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        document.getElementById('listLocationForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const url = 'http://localhost:3000/lo';

            const response = await fetch(url, { 
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

        document.getElementById('loadEventForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const loadEventId = document.getElementById('loadEventId').value;
            const url = 'http://localhost:3000/loadEvent/'+loadEventId;

            const response = await fetch(url, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
            });
            const eventData = await response.json();
            document.getElementById('name').value = eventData.name;
            document.getElementById('quota').value = eventData.quota;
            document.getElementById('loc').value = eventData.loc;
        });

        document.getElementById('updateEventForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            let updateEventId = document.getElementById('loadEventId').value;
            const name = document.getElementById('name').value;
            const quota = document.getElementById('quota').value;
            const loc = document.getElementById('loc').value;
            const url = 'http://localhost:3000/ev/'+updateEventId;

            const data = {
                "name": name,
                "locationId": loc,
                "quota": quota,
            };
            const response = await fetch(url, { 
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data),
            });

            const resultPage = await response.text();
            document.open();
            document.write(resultPage);
            document.close();
        });

    </script>

</body>
</html>